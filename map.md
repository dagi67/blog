#### Метод map

Метод **map** применяется к коллекциям или массивам, в том случае, когда вы хотите получить практически идентичный массив, но с некоторым изменениями всех элементов.

В метод **map** принимает в качестве аргумента блок кода, который должен выполниться над каждым элементом массива, что бы построить новый массив.

В блоке кода следует указать имя ссылки на текущий элемент исходного массива. В слудующем примере это указание выглядит так: <b>|item|</b>

Предположим, что у нас есть массив с сокращенными названиями месяцев:

```ruby
MONTH_LOCALE = %w[nil Янв Фев Мар Апр Май Июн Июл Авг Сен Окт Ноя Дек]
```

Хотелось бы получить похожий массив, но что бы после каждого строкового значения стояла точка.

```
[nil Янв. Фев. Мар. Апр. Май. Июн. Июл. Авг. Сен. Окт. Ноя. Дек.]
```

Реализуется это следующим образом:

```ruby
MONTH_DOT_LOCALE = MONTH_LOCALE.map{|item| item.nil? ? nil : (item + '.') }
```

Мы перебираем исходный массив методом map:

```ruby
MONTH_LOCALE.map{ ... }
```

Всякий элемент исходного массива в блоке будет обозначаться ссылкой item

```ruby
{ |item| ...  }
```

Если этот элемент - **nil**, то вернем nil, в ином случае к **item** прибавим символ **.** (точка)

```ruby
{|item| item.nil? ? nil : (item + '.') }
```

В результате в MONTH_DOT_LOCALE получим ожиаемый массив:

```
[nil Янв. Фев. Мар. Апр. Май. Июн. Июл. Авг. Сен. Окт. Ноя. Дек.]
```

#### map и объекты

Иногда требуется собрать массив из полей некоторых объектов.

Например, есть несколько записей с **IP** адресами и мы хотим выбрать массив **IP** из этих объектов.

```ruby
logs = [
  { id: 1, ip: '128.34.123.12', user: :ivan },
  { id: 2, ip: '145.12.17.46',  user: :john },
  { id: 3, ip: '10.15.89.90',   user: :lola }
]
```

```ruby
logs.map{|item| item[:ip] }
```

Существует удобный способ сбора полей в объекте, если свойства объекта преставлены методами:

Например:

```ruby
logs.map(&:object_id)
```

```ruby
=> [11996740, 11996700, 11996520]
```

1) Когда ruby встречает амперсанд (&) в последнем аргументе вызова метода, то пытается превратить его в выполняемый блок кода (Proc).
2) ruby, встречая амперсанд, превращает обьект в выполняемый блок через вызов метода #to_proc.

```
def ampersand_test_method
  yield if block_given?
end

class ToSKlass
  def self.to_proc
    Proc.new{ |obj| obj.to_s }
  end
end

class ToSKlass2
  def self.to_s
    "Class Name"
  end
end

amperand_test_method ToSKlass
amperand_test_method &ToSKlass
amperand_test_method &ToSKlass2

a = [2, 45, 190]

a.map(&ToSKlass)
```
